## 享元模式（Flyweight Pattern）

![享元模式](https://github.com/GRain-long/ddstudy/blob/dev/ddstudy-designpattern/src/main/resources/image/flyweight.png)

### 定义

&emsp;&emsp;使用共享对象可有效地支持大量的细粒度的对象。

### 说明

&emsp;&emsp;享元模式属于结构型模式的一种，主要注意2点：1.细粒度的对象;2.共享对象。

&emsp;&emsp;利用池化的思想，内部通过维护一个HashMap，共享且重用之前创建过的对象，以减少内存占用和提高性能。享元模式就相当于是工厂模式+HashMap。

&emsp;&emsp;一般来说，可将对象信息分为两个部分：内部状态与外部状态。

- 内部状态

&emsp;&emsp;内部状态是对象可共享出来的信息，存储在享元对象内部并且不会随环境改变而改变，它们可以作为一个对象的动态附加信息，不必直接储存 在具体某个对象中，属于可以共享的部分。

- 外部状态

&emsp;&emsp;外部状态是对象得以依赖的一个标记，是随环境改变而改变的、不可以共享的状态，它是一批对象的统一标识，是唯一的一个索引值。

### 优缺点

&emsp;&emsp;大大减少了应用程序创建的对象，降低程序内存的占用，增强程序的性；

&emsp;&emsp;同时也提高了系统复杂性，需要分离出外部状态和内部状态，而且外部状态具有固化属性，不应该随内部状态的改变而改变，否则会导致系统的逻辑混乱。

### 适用场景

- 系统中存在大量使用的对象
- 需要缓冲池的场景

### 实际场景

- Java中的String对象
- 数据库的连接池

